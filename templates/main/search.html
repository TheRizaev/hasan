{% extends 'main/base.html' %}
{% load static %}

{% block title %}{{ query }} - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ - KRONIK{% endblock %}

{% block content %}
<div class="search-results-container">
    <h1 class="search-heading">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: <span class="search-query">{{ query }}</span> üê∞</h1>
    
    <div class="search-filter">
        <div class="filter-item active" data-filter="all">–í—Å–µ</div>
        <div class="filter-item" data-filter="videos">–í–∏–¥–µ–æ</div>
        <div class="filter-item" data-filter="courses">–ö—É—Ä—Å—ã</div>
        <div class="filter-item" data-filter="channels">–ö–∞–Ω–∞–ª—ã</div>
    </div>
    
    <div class="search-results-list" id="search-results-container">
        {% if videos %}
            {% for video in videos %}
            <div class="search-result-item" data-type="videos" onclick="window.location.href = '/video/{{ video.user_id }}__{{ video.video_id }}/'">
                <div class="result-thumbnail">
                    {% if video.thumbnail_url %}
                        <img src="{{ video.thumbnail_url }}" alt="{{ video.title }}" loading="lazy" onerror="this.src='{% static 'placeholder.jpg' %}'">
                    {% else %}
                        <img src="{% static 'placeholder.jpg' %}" alt="{{ video.title }}" loading="lazy" data-user-id="{{ video.user_id }}" data-video-id="{{ video.video_id }}" class="lazy-thumbnail">
                    {% endif %}
                    <div class="result-duration">{{ video.duration|default:"00:00" }}</div>
                </div>
                <div class="result-details">
                    <h3 class="result-title">{{ video.title }}</h3>
                    <div class="result-meta">{{ video.views_formatted|default:"0 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤" }} ‚Ä¢ {{ video.upload_date_formatted|default:"–ù–µ–¥–∞–≤–Ω–æ" }}</div>
                    <div class="result-channel">
                        <div class="channel-avatar">{{ video.display_name|first|default:video.channel|first }}</div>
                        <div class="channel-name">{{ video.display_name|default:video.channel }}</div>
                    </div>
                    <div class="result-description">
                        {{ video.description|default:""|truncatechars:150 }}
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-results">
                <h3>–ü–æ –∑–∞–ø—Ä–æ—Å—É "{{ query }}" –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</p>
                <div class="search-suggestions">
                    <h4>–í–æ–∑–º–æ–∂–Ω–æ, –≤–∞—Å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç:</h4>
                    <div class="suggestion-tags">
                        <a href="/search?query=–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ" class="suggestion-tag">–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
                        <a href="/search?query=–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞" class="suggestion-tag">–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞</a>
                        <a href="/search?query=—Ñ–∏–∑–∏–∫–∞" class="suggestion-tag">—Ñ–∏–∑–∏–∫–∞</a>
                        <a href="/search?query=–∏—Å—Ç–æ—Ä–∏—è" class="suggestion-tag">–∏—Å—Ç–æ—Ä–∏—è</a>
                        <a href="/search?query=CORE" class="suggestion-tag">CORE</a>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
    
    {% if videos|length >= 10 %}
    <div class="load-more-container">
        <button id="load-more-btn" class="load-more-button">–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë</button>
    </div>
    {% endif %}
    
    <!-- –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="debug-toggle-container">
        <button id="toggle-debug" class="debug-toggle">–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</button>
    </div>
    
    <div id="debug-info" class="debug-info" style="display:none;">
        <h3>–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        
        <div class="debug-section">
            <h4>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞</h4>
            <div class="debug-content">
                <p><strong>–ó–∞–ø—Ä–æ—Å:</strong> {{ debug.query }}</p>
                <p><strong>–°–º–µ—â–µ–Ω–∏–µ:</strong> {{ debug.offset }}</p>
                <p><strong>–õ–∏–º–∏—Ç:</strong> {{ debug.limit }}</p>
                <p><strong>–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ –≤–∏–¥–µ–æ:</strong> {{ debug.total_videos_found|default:"0" }}</p>
                <p><strong>–ù–∞–π–¥–µ–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:</strong> {{ debug.total_results|default:"0" }}</p>
                <p><strong>–í–æ–∑–≤—Ä–∞—â–µ–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:</strong> {{ debug.results_returned|default:"0" }}</p>
            </div>
        </div>
        
        <div class="debug-section">
            <h4>–®–∞–≥–∏ –ø–æ–∏—Å–∫–∞</h4>
            <div class="debug-content">
                <ol>
                    {% for step in debug.scan_steps %}
                    <li>{{ step }}</li>
                    {% empty %}
                    <li>–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —à–∞–≥–∞—Ö –ø–æ–∏—Å–∫–∞</li>
                    {% endfor %}
                </ol>
            </div>
        </div>
        
        {% if debug.core_videos_count is not None %}
        <div class="debug-section">
            <h4>–í–∏–¥–µ–æ —Å "CORE" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ ({{ debug.core_videos_count }})</h4>
            <div class="debug-content">
                <ul>
                    {% for video in debug.core_videos %}
                    <li>{{ video.title }} ({{ video.user_id }}/{{ video.video_id }})</li>
                    {% empty %}
                    <li>–ù–µ –Ω–∞–π–¥–µ–Ω–æ –≤–∏–¥–µ–æ —Å "CORE" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        {% endif %}
        
        <div class="debug-section">
            <h4>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ({{ debug.users|length }} –∏–∑ {{ debug.users|length }})</h4>
            <div class="debug-content">
                <ul>
                    {% for user in debug.users %}
                    <li>{{ user }}</li>
                    {% empty %}
                    <li>–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        
        <div class="debug-section">
            <h4>–ü—Ä–∏–º–µ—Ä—ã –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ ({{ debug.all_videos_sample|length }} –∏–∑ {{ debug.total_videos_found|default:"0" }})</h4>
            <div class="debug-content">
                <ul>
                    {% for video in debug.all_videos_sample %}
                    <li>{{ video.title }} ({{ video.user_id }}/{{ video.video_id }})</li>
                    {% empty %}
                    <li>–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        
        <div class="debug-section">
            <h4>–û—à–∏–±–∫–∏</h4>
            <div class="debug-content">
                <ul>
                    {% for error in debug.errors %}
                    <li class="error">{{ error }}</li>
                    {% empty %}
                    <li>–ù–µ—Ç –æ—à–∏–±–æ–∫</li>
                    {% endfor %}
                </ul>
                
                {% if debug.traceback %}
                <div class="debug-traceback">
                    <h5>Traceback</h5>
                    <pre>{{ debug.traceback }}</pre>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<style>
    /* Additional styles for search results page */
    .search-suggestions {
        margin-top: 20px;
        padding: 15px;
        background-color: rgba(159, 37, 88, 0.05);
        border-radius: 8px;
    }
    
    .dark-theme .search-suggestions {
        background-color: rgba(159, 37, 88, 0.1);
    }
    
    .suggestion-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
    }
    
    .suggestion-tag {
        padding: 8px 15px;
        background-color: rgba(159, 37, 88, 0.1);
        border-radius: 20px;
        color: var(--primary-color);
        text-decoration: none;
        transition: all 0.3s;
    }
    
    .suggestion-tag:hover {
        background-color: rgba(159, 37, 88, 0.2);
        transform: translateY(-2px);
    }
    
    .load-more-container {
        display: flex;
        justify-content: center;
        margin: 30px 0;
    }
    
    .load-more-button {
        padding: 10px 25px;
        background-color: var(--accent-color);
        color: white;
        border: none;
        border-radius: 30px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .load-more-button:hover {
        background-color: #7d1e46;
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(159, 37, 88, 0.3);
    }
    
    /* Fix for lazy loaded thumbnails */
    .lazy-thumbnail {
        transition: opacity 0.3s;
    }
    
    .lazy-thumbnail.loading {
        opacity: 0.5;
    }
    
    /* Debug info styles */
    .debug-toggle-container {
        display: flex;
        justify-content: center;
        margin: 30px 0 10px;
    }
    
    .debug-toggle {
        background-color: #444;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s;
    }
    
    .debug-toggle:hover {
        background-color: #666;
    }
    
    .debug-info {
        margin: 20px 0;
        padding: 20px;
        background-color: #f5f5f5;
        border-radius: 8px;
        border: 1px solid #ddd;
        font-family: monospace;
        font-size: 14px;
    }
    
    .dark-theme .debug-info {
        background-color: #222;
        border-color: #444;
        color: #ddd;
    }
    
    .debug-section {
        margin-bottom: 20px;
        border-bottom: 1px solid #ddd;
        padding-bottom: 10px;
    }
    
    .dark-theme .debug-section {
        border-color: #444;
    }
    
    .debug-section h4 {
        background-color: #eee;
        padding: 8px 12px;
        margin: 10px 0;
        border-radius: 4px;
        color: #333;
    }
    
    .dark-theme .debug-section h4 {
        background-color: #333;
        color: #fff;
    }
    
    .debug-content {
        padding: 0 12px;
    }
    
    .debug-info .error {
        color: #e74c3c;
    }
    
    .debug-traceback {
        margin-top: 10px;
        padding: 10px;
        background-color: #eee;
        border-radius: 4px;
        overflow-x: auto;
    }
    
    .dark-theme .debug-traceback {
        background-color: #333;
    }
    
    .debug-traceback pre {
        margin: 0;
        white-space: pre-wrap;
        word-wrap: break-word;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–µ–Ω–∏–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –º–∏–Ω–∏–∞—Ç—é—Ä
        initializeLazyLoading();
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        setupFilters();
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ"
        setupLoadMore();

        setupDebugToggle();
    });
    
    // –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–∏–Ω–∏–∞—Ç—é—Ä
    function initializeLazyLoading() {
        if ('IntersectionObserver' in window) {
            const imageObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        const videoId = img.getAttribute('data-video-id');
                        const userId = img.getAttribute('data-user-id');
                        
                        if (videoId && userId) {
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ URL –≤ sessionStorage
                            const cachedUrl = sessionStorage.getItem(`thumbnail_${userId}__${videoId}`);
                            
                            if (cachedUrl) {
                                img.src = cachedUrl;
                                img.classList.remove('lazy-thumbnail', 'loading');
                                imageObserver.unobserve(img);
                            } else {
                                // –û—Ç–º–µ—á–∞–µ–º –∫–∞–∫ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–π
                                img.classList.add('loading');
                                
                                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º URL –º–∏–Ω–∏–∞—Ç—é—Ä—ã
                                fetch(`/api/get-thumbnail-url/${userId}__${videoId}/`)
                                    .then(response => response.json())
                                    .then(data => {
                                        if (data.success && data.url) {
                                            // –ö—ç—à–∏—Ä—É–µ–º URL
                                            sessionStorage.setItem(`thumbnail_${userId}__${videoId}`, data.url);
                                            
                                            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                                            img.src = data.url;
                                            img.classList.remove('lazy-thumbnail', 'loading');
                                            
                                            // –ü—Ä–µ–∫—Ä–∞—â–∞–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ
                                            imageObserver.unobserve(img);
                                        }
                                    })
                                    .catch(error => {
                                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∏–Ω–∏–∞—Ç—é—Ä—ã:', error);
                                        img.classList.remove('loading');
                                    });
                            }
                        }
                    }
                });
            }, {
                rootMargin: '200px 0px',
                threshold: 0.01
            });
            
            // –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –≤—Å–µ–º–∏ –ª–µ–Ω–∏–≤—ã–º–∏ –º–∏–Ω–∏–∞—Ç—é—Ä–∞–º–∏
            document.querySelectorAll('.lazy-thumbnail').forEach(img => {
                imageObserver.observe(img);
            });
        }
    }
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    function setupFilters() {
        const filterItems = document.querySelectorAll('.filter-item');
        const resultItems = document.querySelectorAll('.search-result-item');
        
        filterItems.forEach(item => {
            item.addEventListener('click', function() {
                // –°–Ω–∏–º–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
                filterItems.forEach(filter => filter.classList.remove('active'));
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ñ–∏–ª—å—Ç—Ä—É
                this.classList.add('active');
                
                // –ü–æ–ª—É—á–∞–µ–º —Ç–∏–ø —Ñ–∏–ª—å—Ç—Ä–∞
                const filterType = this.getAttribute('data-filter');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–∏–ª—å—Ç—Ä–∞
                resultItems.forEach(result => {
                    if (filterType === 'all' || result.getAttribute('data-type') === filterType) {
                        result.style.display = 'flex';
                    } else {
                        result.style.display = 'none';
                    }
                });
            });
        });
    }
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ"
    function setupLoadMore() {
        const loadMoreBtn = document.getElementById('load-more-btn');
        
        if (!loadMoreBtn) return;
        
        // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        const query = urlParams.get('query');
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –ø–æ—Ä—Ü–∏–∏
        let currentOffset = parseInt(document.querySelectorAll('.search-result-item').length);
        
        loadMoreBtn.addEventListener('click', function() {
            this.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
            this.disabled = true;
            
            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –ø–æ—Ä—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            fetch(`/search?query=${encodeURIComponent(query)}&offset=${currentOffset}&format=json`)
                .then(response => response.json())
                .then(data => {
                    if (data.videos && data.videos.length > 0) {
                        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                        appendSearchResults(data.videos);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–º–µ—â–µ–Ω–∏–µ
                        currentOffset += data.videos.length;
                        
                        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ –µ—Å—Ç—å –µ—â–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                        if (data.videos.length < 20 || currentOffset >= data.total) {
                            loadMoreBtn.style.display = 'none';
                        } else {
                            loadMoreBtn.textContent = '–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë';
                            loadMoreBtn.disabled = false;
                        }
                        
                        // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ª–µ–Ω–∏–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É
                        initializeLazyLoading();
                    } else {
                        loadMoreBtn.style.display = 'none';
                    }
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:', error);
                    loadMoreBtn.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
                    setTimeout(() => {
                        loadMoreBtn.textContent = '–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞';
                        loadMoreBtn.disabled = false;
                    }, 2000);
                });
        });
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
    function appendSearchResults(videos) {
        const container = document.getElementById('search-results-container');
        
        videos.forEach(video => {
            const resultItem = document.createElement('div');
            resultItem.className = 'search-result-item';
            resultItem.setAttribute('data-type', 'videos');
            resultItem.onclick = function() {
                window.location.href = `/video/${video.user_id}__${video.video_id}/`;
            };
            
            const thumbnailUrl = video.thumbnail_url || '/static/placeholder.jpg';
            const displayName = video.display_name || video.channel || 'Unknown';
            const firstLetter = displayName.charAt(0);
            
            resultItem.innerHTML = `
                <div class="result-thumbnail">
                    <img src="${thumbnailUrl}" alt="${video.title}" loading="lazy" onerror="this.src='/static/placeholder.jpg'" ${!video.thumbnail_url ? `data-user-id="${video.user_id}" data-video-id="${video.video_id}" class="lazy-thumbnail"` : ''}>
                    <div class="result-duration">${video.duration || '00:00'}</div>
                </div>
                <div class="result-details">
                    <h3 class="result-title">${video.title}</h3>
                    <div class="result-meta">${video.views_formatted || '0 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤'} ‚Ä¢ ${video.upload_date_formatted || '–ù–µ–¥–∞–≤–Ω–æ'}</div>
                    <div class="result-channel">
                        <div class="channel-avatar">${firstLetter}</div>
                        <div class="channel-name">${displayName}</div>
                    </div>
                    <div class="result-description">
                        ${video.description ? (video.description.length > 150 ? video.description.substring(0, 147) + '...' : video.description) : ''}
                    </div>
                </div>
            `;
            
            container.appendChild(resultItem);
        });
    }

    function setupDebugToggle() {
        const toggleButton = document.getElementById('toggle-debug');
        const debugInfo = document.getElementById('debug-info');
        
        if (toggleButton && debugInfo) {
            toggleButton.addEventListener('click', function() {
                const isVisible = debugInfo.style.display !== 'none';
                debugInfo.style.display = isVisible ? 'none' : 'block';
                toggleButton.textContent = isVisible ? '–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é' : '–°–∫—Ä—ã—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é';
            });
        }
    }
</script>
{% endblock %}